"use strict";(self.webpackChunkbeauty_docs=self.webpackChunkbeauty_docs||[]).push([[2568],{4271:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"Getting Started/exceptions","title":"Handle Exceptions","description":"In Beauty Framework, exceptions are the primary way to interrupt the request flow and return error responses. This approach keeps your controller and middleware logic clean while maintaining full control over the HTTP response.","source":"@site/docs/2-Getting Started/exceptions.md","sourceDirName":"2-Getting Started","slug":"/Getting Started/exceptions","permalink":"/docs/Getting Started/exceptions","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Add Middleware","permalink":"/docs/Getting Started/middlewares"},"next":{"title":"Work with Database (Repositories)","permalink":"/docs/Getting Started/data"}}');var t=o(4848),s=o(8453);const i={sidebar_position:5},a="Handle Exceptions",l={},c=[{value:"\ud83d\udd25 Example: Unauthorized Access",id:"-example-unauthorized-access",level:2},{value:"\ud83d\udd04 Response Example",id:"-response-example",level:3},{value:"\ud83e\uddf1 Custom Exceptions",id:"-custom-exceptions",level:2},{value:"\u2699\ufe0f Built-in Exception Support",id:"\ufe0f-built-in-exception-support",level:2},{value:"\u2699\ufe0f Custom Exception Flow",id:"\ufe0f-custom-exception-flow",level:2},{value:"\ud83d\udca1 Notes",id:"-notes",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"handle-exceptions",children:"Handle Exceptions"})}),"\n",(0,t.jsx)(n.p,{children:"In Beauty Framework, exceptions are the primary way to interrupt the request flow and return error responses. This approach keeps your controller and middleware logic clean while maintaining full control over the HTTP response."}),"\n",(0,t.jsx)(n.h2,{id:"-example-unauthorized-access",children:"\ud83d\udd25 Example: Unauthorized Access"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"throw new UnauthorizedException('Missing or invalid token');\n"})}),"\n",(0,t.jsx)(n.p,{children:"If an exception is thrown anywhere in your middleware, controller, or service, it will be caught and transformed into a proper JSON response automatically."}),"\n",(0,t.jsx)(n.h3,{id:"-response-example",children:"\ud83d\udd04 Response Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "error": "Unauthorized",\n  "message": "Missing or invalid token"\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["With HTTP status code: ",(0,t.jsx)(n.code,{children:"401 Unauthorized"})]}),"\n",(0,t.jsx)(n.h2,{id:"-custom-exceptions",children:"\ud83e\uddf1 Custom Exceptions"}),"\n",(0,t.jsxs)(n.p,{children:["You can define your own exceptions by extending ",(0,t.jsx)(n.code,{children:"\\Exception"})," or any base class you prefer:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"namespace App\\Exceptions;\n\nclass UnauthorizedException extends \\Exception\n{\n}\n"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"You can also override the constructor of your custom exception to simplify message handling or pass additional data. This gives you full flexibility over how errors are represented and returned."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"\ufe0f-built-in-exception-support",children:"\u2699\ufe0f Built-in Exception Support"}),"\n",(0,t.jsx)(n.p,{children:"Beauty Framework provides built-in support for:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"ValidationException"})," \u2014 auto-thrown from ",(0,t.jsx)(n.code,{children:"ValidatedRequest"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"HttpException"})," \u2014 base exception for manual responses"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The exception system is extremely flexible \u2014 you can define and handle any exception type the way you want, whether globally in the worker or locally in your code. No strict interface or inheritance is required."}),"\n",(0,t.jsx)(n.h2,{id:"\ufe0f-custom-exception-flow",children:"\u2699\ufe0f Custom Exception Flow"}),"\n",(0,t.jsxs)(n.p,{children:["If you need full control over how specific exceptions are handled, you can customize the error flow in your ",(0,t.jsx)(n.code,{children:"workers/http-worker.php"})," file. For example:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"if ($psrRequest = $worker->waitRequest()) {\n    try {\n        // ...handle request and convert to HttpRequest\n        $response = $app->handle($request);\n        $worker->respond($response);\n    } catch (ValidationException $e) {\n        $worker->respond(new JsonResponse(400, new ValidationResponse($e->getMessage(), $e->getFails())));\n    } catch (UnauthorizedException $e) {\n        $worker->respond(new JsonResponse(401, new ErrorResponse($e->getMessage())));\n    } catch (Throwable $e) {\n        $worker->respond(new JsonResponse(500, new ErrorResponse($e->getMessage())));\n        $worker->getWorker()->error((string)$e);\n    }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"This allows you to define precise responses for each exception type."}),"\n",(0,t.jsx)(n.h2,{id:"-notes",children:"\ud83d\udca1 Notes"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Exceptions short-circuit the pipeline \u2014 no further middleware or controller logic will be executed"}),"\n",(0,t.jsx)(n.li,{children:"You can return different status codes for different exception types"}),"\n",(0,t.jsx)(n.li,{children:"Logs and error reporting are handled globally"}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Use exceptions to clearly express failure conditions \u2014 and let the framework handle the rest."}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>a});var r=o(6540);const t={},s=r.createContext(t);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);